require feNeuralNet;

operator entry() {
  Integer layerSizes[];
  layerSizes.push(2);
  layerSizes.push(10);
  layerSizes.push(4);
  
  Net net1();
  net1.setPatternNetTopo(layerSizes);
  
  Matrix hiddenWeights();
  Matrix hiddenBiases();
  hiddenWeights.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\weights1.txt"));
  hiddenBiases.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\biases1.txt"));
  net1.setWeights(Vec2(1,0), hiddenWeights);
  net1.setBiases(Vec2(1,0), hiddenBiases);

  Matrix outputWeights();
  Matrix outputBiases();
  outputWeights.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\weights2.txt"));
  outputBiases.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\biases2.txt"));
  net1.setWeights(Vec2(2,1), outputWeights);
  net1.setBiases(Vec2(2,1), outputBiases);

  report(net1);

  Matrix inputs();
  inputs.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\inputs.txt"));

  Matrix outputs();
  outputs = net1.feedForward(inputs);
  outputs.longArray = truncateDecimals(outputs.longArray,1);

  report(outputs.desc());
}