require feNeuralNet;

operator entry() {
  Integer layerId;

  Net net();
  Layer input('input', 2);
  net.addInputLayer(input, layerId);
  
  Layer hidden('hidden', 10, 'tansig');
  Mat hiddenWeights();
  Mat hiddenBias();
  hiddenWeights.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\weights1.txt"));
  hiddenBias.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\biases1.txt"));
  net.addConnectedLayer(hidden, hiddenWeights, hiddenBias, layerId);

  Layer output('output', 4);
  Mat outputWeights();
  Mat outputBiases();
  outputWeights.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\weights2.txt"));
  outputBiases.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\biases2.txt"));
  net.addConnectedLayer(output, outputWeights, outputBiases, layerId);
  
  net.setOutput(layerId);

  report(net);

  Mat inputs();
  inputs.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\inputs.txt"));

  Mat outputs();
  outputs = net.feedForward(inputs);
  
  report(outputs);
}