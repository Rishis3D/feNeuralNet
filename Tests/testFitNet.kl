require feNeuralNet;

operator entry() {
  Integer layerSizes[];
  layerSizes.push(20);
  layerSizes.push(10);
  layerSizes.push(1);
  
  Net net1();
  net1.setFitNetTopo(layerSizes);
  
  Matrix hiddenWeights();
  Matrix hiddenBiases();
  hiddenWeights.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\weights1.txt"));
  hiddenBiases.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\biases1.txt"));
  net1.setWeights(Vec2(1,0), hiddenWeights);
  net1.setBiases(Vec2(1,0), hiddenBiases);

  Matrix outputWeights();
  Matrix outputBiases();
  outputWeights.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\weights2.txt"));
  outputBiases.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\biases2.txt"));
  net1.setWeights(Vec2(2,1), outputWeights);
  net1.setBiases(Vec2(2,1), outputBiases);

  Matrix inputs();
  inputs.fromFile(FilePath("C:\\Users\\gusta\\Desktop\\inputs.txt"));

  report(net1.feedForward(inputs).desc());
}